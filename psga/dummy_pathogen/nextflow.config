// load the main config
includeConfig './common/common.config'

manifest {
    name = "Congenica PSGA/dummy_pathogen pipeline"
    description = "Pathogen Sequence Genome Analysis pipeline for dummy_pathogen pathogen"
    author = 'Congenica'
    homePage = 'https://www.congenica.com/'
    mainScript = 'main.nf'
    nextflowVersion = '>= 21.10.4'
    version = '1.0.0'
}

env {
    // docker image config
    DUMMY_PATHOGEN_PIPELINE_DOCKER_IMAGE_TAG = "${DUMMY_PATHOGEN_PIPELINE_DOCKER_IMAGE_TAG}"
}

process {

    withName:fastqc {
        executor = 'k8s'
        container = "${env.DOCKER_IMAGE_PREFIX}/dummy-pathogen-pipeline:${env.DUMMY_PATHOGEN_PIPELINE_DOCKER_IMAGE_TAG}"
        errorStrategy = { (task.exitStatus != 0 && task.attempt <= "${env.K8S_PROCESS_MAX_RETRIES}" as int) ? 'retry' : 'ignore' }
    }

    withName:generate_dummy_output {
        executor = 'k8s'
        container = "${env.DOCKER_IMAGE_PREFIX}/dummy-pathogen-pipeline:${env.DUMMY_PATHOGEN_PIPELINE_DOCKER_IMAGE_TAG}"
    }

}
